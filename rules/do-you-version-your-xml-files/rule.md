---
type: rule
archivedreason: 
title: Do you version your .xml files?
guid: fe869a35-0ca6-4558-89ac-3e79ef775018
uri: do-you-version-your-xml-files
created: 2009-04-29T06:07:29.0000000Z
authors:
- title: Adam Cogan
  url: https://ssw.com.au/people/adam-cogan
- title: Ryan Tee
  url: https://ssw.com.au/people/ryan-tee
related: []
redirects: []

---


It is good to store program settings in an .xml file. But developers rarely worry about future schema changes and how they will inform the user it is an old schema.<br>
<br>
What is wrong with this?

<br><excerpt class='endintro'></excerpt><br>

  <dl class="badCode">
    <dt style="width&#58;93.74%;height&#58;904px;">
    <pre>{ltHTMLChar}?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?{gtHTMLChar}<br>{ltHTMLChar}NewDataSet{gtHTMLChar}<br>  {ltHTMLChar}xs&#58;schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot;<br>   &#160;&#160;xmlns&#58;xs=&quot;http&#58;//www.w3.org/2001/XMLSchema&quot;<br>   &#160;&#160;xmlns&#58;msdata=&quot;urn&#58;schemas-microsoft-com&#58;xml-msdata&quot;{gtHTMLChar}<br>    {ltHTMLChar}xs&#58;element name=NewDataSet&quot; msdata&#58;IsDataSet=&quot;true&quot; msdata&#58;Locale=&quot;en-AU&quot;{gtHTMLChar}<br>    {ltHTMLChar}xs&#58;complexType{gtHTMLChar}<br>      {ltHTMLChar}xs&#58;choice maxOccurs=&quot;unbounded&quot;{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;Table1&quot;{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;complexType{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;sequence{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;DateUpdated&quot; type=&quot;xs&#58;dateTime&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;NewDatabase&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;ConnectionString&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;SQLFilePath&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;TimeOut&quot; type=&quot;xs&#58;int&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;TurnOnMSDE&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;KeepXMLRecords&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;UserMode&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;ReconcileScriptsMode&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;FolderPath&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar} /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;SelectedFile&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;UpdateVersionTable&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}/xs&#58;sequence{gtHTMLChar}<br>       {ltHTMLChar}/xs&#58;complexType{gtHTMLChar}<br>       {ltHTMLChar}/xs&#58;element{gtHTMLChar}<br>      {ltHTMLChar}/xs&#58;choice{gtHTMLChar}<br>     {ltHTMLChar}/xs&#58;complexType{gtHTMLChar}<br>    &#160;{ltHTMLChar}/xs&#58;element{gtHTMLChar}<br>  &#160;&#160;{ltHTMLChar}/xs&#58;schema{gtHTMLChar}<br> <br>  &#160;&#160;{ltHTMLChar}Table1{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}DateUpdated{gtHTMLChar}2004-05-17T10&#58;04&#58;06.9438192+10&#58;00{ltHTMLChar}/DateUpdated{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}NewDatabase{gtHTMLChar}true{ltHTMLChar}/NewDatabase{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}ConnectionString{gtHTMLChar}Provider=SQLOLEDB.1;Integrated Security=SSPI;<br>      Persist Security Info=False;<br>      Data Source=(local);Initial Catalog=master{ltHTMLChar}/ConnectionString{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}SQLFilePath{gtHTMLChar}ver0001.sql{ltHTMLChar}/SQLFilePath{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}TimeOut{gtHTMLChar}5{ltHTMLChar}/TimeOut{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}TurnOnMSDE{gtHTMLChar}false{ltHTMLChar}/TurnOnMSDE{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}KeepXMLRecords{gtHTMLChar}false{ltHTMLChar}/KeepXMLRecords{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}UserMode{gtHTMLChar}true{ltHTMLChar}/UserMode{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}ReconcileScriptsMode{gtHTMLChar}true{ltHTMLChar}/ReconcileScriptsMode{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}FolderPath{gtHTMLChar}C&#58;\Program Files\SSW SQL Deploy\Samples\DatabaseSQLScripts\<br>      {ltHTMLChar}/FolderPath{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}SelectedFile /{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}UpdateVersionTable{gtHTMLChar}true{ltHTMLChar}/UpdateVersionTable{gtHTMLChar}<br>  &#160;&#160;{ltHTMLChar}/Table1{gtHTMLChar}<br>{ltHTMLChar}/NewDataSet{gtHTMLChar}</pre>
    </dt>
    <dd>Bad example - XML file without version control.</dd>
</dl>
<dl class="goodCode">
    <dt style="width&#58;93.74%;height&#58;949px;">
    <pre>{ltHTMLChar}?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?{gtHTMLChar}<br>{ltHTMLChar}NewDataSet{gtHTMLChar}<br>  {ltHTMLChar}xs&#58;schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot;<br>   &#160;&#160;xmlns&#58;xs=&quot;http&#58;//www.w3.org/2001/XMLSchema&quot;<br>   &#160;&#160;xmlns&#58;msdata=&quot;urn&#58;schemas-microsoft-com&#58;xml-msdata&quot;{gtHTMLChar}<br>    {ltHTMLChar}xs&#58;element name=NewDataSet&quot; msdata&#58;IsDataSet=&quot;true&quot; msdata&#58;Locale=&quot;en-AU&quot;{gtHTMLChar}<br>    {ltHTMLChar}xs&#58;complexType{gtHTMLChar}<br>      {ltHTMLChar}xs&#58;choice maxOccurs=&quot;unbounded&quot;{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;Table1&quot;{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;complexType{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;sequence{gtHTMLChar}<br>       <span style="background-color&#58;#ffff00;">{ltHTMLChar}xs&#58;element name=&quot;Version&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}</span><br>       {ltHTMLChar}xs&#58;element name=&quot;DateUpdated&quot; type=&quot;xs&#58;dateTime&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;NewDatabase&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;ConnectionString&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;SQLFilePath&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;TimeOut&quot; type=&quot;xs&#58;int&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;TurnOnMSDE&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;KeepXMLRecords&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;UserMode&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;ReconcileScriptsMode&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;FolderPath&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar} /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;SelectedFile&quot; type=&quot;xs&#58;string&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}xs&#58;element name=&quot;UpdateVersionTable&quot; type=&quot;xs&#58;boolean&quot; minOccurs=&quot;0&quot; /{gtHTMLChar}<br>       {ltHTMLChar}/xs&#58;sequence{gtHTMLChar}<br>       {ltHTMLChar}/xs&#58;complexType{gtHTMLChar}<br>       {ltHTMLChar}/xs&#58;element{gtHTMLChar}<br>      {ltHTMLChar}/xs&#58;choice{gtHTMLChar}<br>     {ltHTMLChar}/xs&#58;complexType{gtHTMLChar}<br>    &#160;{ltHTMLChar}/xs&#58;element{gtHTMLChar}<br>  &#160;&#160;{ltHTMLChar}/xs&#58;schema{gtHTMLChar}<br> <br> &#160;&#160;{ltHTMLChar}Table1{gtHTMLChar}<br>      <span style="background-color&#58;#ffff00;">{ltHTMLChar}Version{gtHTMLChar}1.2{ltHTMLChar}/Version{gtHTMLChar}</span> <br>  &#160;&#160;  {ltHTMLChar}DateUpdated{gtHTMLChar}2004-05-17T10&#58;04&#58;06.9438192+10&#58;00{ltHTMLChar}/DateUpdated{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}NewDatabase{gtHTMLChar}true{ltHTMLChar}/NewDatabase{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}ConnectionString{gtHTMLChar}Provider=SQLOLEDB.1;Integrated Security=SSPI;<br>      Persist Security Info=False;<br>      Data Source=(local);Initial Catalog=master{ltHTMLChar}/ConnectionString{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}SQLFilePath{gtHTMLChar}ver0001.sql{ltHTMLChar}/SQLFilePath{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}TimeOut{gtHTMLChar}5{ltHTMLChar}/TimeOut{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}TurnOnMSDE{gtHTMLChar}false{ltHTMLChar}/TurnOnMSDE{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}KeepXMLRecords{gtHTMLChar}false{ltHTMLChar}/KeepXMLRecords{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}UserMode{gtHTMLChar}true{ltHTMLChar}/UserMode{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}ReconcileScriptsMode{gtHTMLChar}true{ltHTMLChar}/ReconcileScriptsMode{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}FolderPath{gtHTMLChar}C&#58;\Program Files\SSW SQL Deploy\Samples\DatabaseSQLScripts\<br>      {ltHTMLChar}/FolderPath{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}SelectedFile /{gtHTMLChar}<br>    &#160;&#160;{ltHTMLChar}UpdateVersionTable{gtHTMLChar}true{ltHTMLChar}/UpdateVersionTable{gtHTMLChar}<br>  &#160;&#160;{ltHTMLChar}/Table1{gtHTMLChar}<br>{ltHTMLChar}/NewDataSet{gtHTMLChar}</pre>
    </dt>
    <dd>Good example -&#160;XML file with version control</dd>
</dl>
<p>The version tags identifies what version the file is. This version should be hard coded into the application. Every time you change the format of the file, you would increment this number.</p>
<p>The code below shows how this would be implemented in your project.</p>
<dl class="goodCode">
    <dt style="width&#58;95.06%;height&#58;765px;">
    <pre>Public Function IsXMLFileValid() As Boolean<br><br>  Dim fileVersion As String = &quot;not specified&quot;<br>  Dim dsSettings As New DataSet<br>  Dim IsMalformed As Boolean = False <br>  ' Is the file malformed all together with possibly version<br><br>  Try<br>    dsSettings.ReadXml(mXMLFileInfo.FullName, XmlReadMode.ReadSchema)<br>  Catch ex As Exception<br>    IsMalformed = True<br>  End Try<br><br>  If (Not IsMalformed) Then<br>    Dim strm As Stream = Asm.GetManifestResourceStream(Asm.GetName().Name _ <br>     + &quot;.&quot; + &quot;XMLFileSchema.xsd&quot;)<br>   &#160;Dim sReader As New StreamReader(strm)<br>   &#160;Dim dsXMLSchema As New DataSet<br>   &#160;dsXMLSchema.ReadXmlSchema(sReader)<br><br>   &#160;If dsSettings.Tables(0).Columns.Contains(&quot;Version&quot;) Then _<br>    &#160;&#160;fileVersion = dsSettings.Tables(0).Rows(0)(&quot;Version&quot;).ToString<br>    End If<br><br>   &#160;If fileVersion = &quot;&quot; Then<br>   &#160;&#160;&#160;fileVersion = &quot;not specified&quot;<br>  &#160;&#160;End If<br><br>   &#160;If fileVersion = Global.XMLFileVersion AndAlso <br>        Not dsSettings.GetXmlSchema() = dsXMLSchema.GetXmlSchema() Then<br>   &#160;&#160;&#160;Return False<br>   &#160;End If<br><br>  End If<br><br>  If IsMalformed OrElse fileVersion {ltHTMLChar}{gtHTMLChar} Global.XMLFileVersion Then<br><br>  &#160;&#160;If mshouldConvertFile Then<br>    &#160; ' Convert the file<br>    &#160; ConvertToCurrentVersion(IsMalformed)<br>    Else<br>     &#160;Throw New XMLFileVersionException(fileVersion, Global.XMLFileVersion )<br>    End If<br><br>  End If<br><br>  Return True<br><br>End Function</pre>
    </dt>
</dl>
<b>Figure&#58; Code to illustrate how to check if the xml file is valid.</b>
<p>Note&#58; to allow backward compatibility, you should give the user an option to convert old xml files into the new version structure.</p>



